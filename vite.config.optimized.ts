import { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\nimport { visualizer } from 'rollup-plugin-visualizer';\nimport compression from 'vite-plugin-compression';\n\nexport default defineConfig({\n  plugins: [\n    react({\n      // Enable fast refresh\n      fastRefresh: true,\n      // Babel optimization\n      babel: {\n        plugins: [\n          ['@babel/plugin-proposal-decorators', { legacy: true }],\n          '@babel/plugin-proposal-class-properties',\n        ],\n      },\n    }),\n    // Compression plugin\n    compression({\n      verbose: true,\n      disable: false,\n      threshold: 10240,\n      algorithm: 'brotli',\n      ext: '.br',\n    }),\n    compression({\n      verbose: true,\n      disable: false,\n      threshold: 10240,\n      algorithm: 'gzip',\n      ext: '.gz',\n    }),\n    // Bundle analyzer\n    visualizer({\n      open: false,\n      gzipSize: true,\n      brotliSize: true,\n      filename: 'dist/stats.html',\n    }),\n  ],\n\n  build: {\n    // Optimization settings\n    minify: 'terser',\n    terserOptions: {\n      compress: {\n        drop_console: true,\n        drop_debugger: true,\n        pure_funcs: ['console.log', 'console.info'],\n      },\n      format: {\n        comments: false,\n      },\n    },\n\n    // Code splitting\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          // Vendor chunks\n          'vendor-react': ['react', 'react-dom'],\n          'vendor-ui': ['@radix-ui/react-dialog', '@radix-ui/react-dropdown-menu'],\n          'vendor-utils': ['axios', 'date-fns', 'lodash-es'],\n          'vendor-charts': ['recharts'],\n\n          // Feature chunks\n          'feature-auth': ['./src/pages/LoginPage.tsx', './src/pages/RegisterPage.tsx'],\n          'feature-dashboard': ['./src/pages/DashboardPage.tsx', './src/components/DashboardWelcome.tsx'],\n          'feature-coach': ['./src/pages/CoachOSPage.tsx', './src/components/CoachPersonality.tsx'],\n          'feature-analytics': ['./src/pages/AnalyticsDashboardPage.tsx'],\n          'feature-social': ['./src/pages/SocialPage.tsx', './src/pages/LeaderboardPage.tsx'],\n          'feature-admin': ['./src/pages/AdminDashboardPage.tsx'],\n          'feature-premium': ['./src/pages/PremiumDashboardPage.tsx'],\n        },\n        // Optimize chunk sizes\n        chunkFileNames: 'js/[name]-[hash].js',\n        entryFileNames: 'js/[name]-[hash].js',\n        assetFileNames: (assetInfo) => {\n          const info = assetInfo.name.split('.');\n          const ext = info[info.length - 1];\n          if (/png|jpe?g|gif|svg/.test(ext)) {\n            return `images/[name]-[hash][extname]`;\n          } else if (/woff|woff2|eot|ttf|otf/.test(ext)) {\n            return `fonts/[name]-[hash][extname]`;\n          } else if (ext === 'css') {\n            return `css/[name]-[hash][extname]`;\n          }\n          return `[name]-[hash][extname]`;\n        },\n      },\n    },\n\n    // Performance hints\n    reportCompressedSize: true,\n    chunkSizeWarningLimit: 500,\n\n    // Source maps for production\n    sourcemap: 'hidden',\n  },\n\n  // Optimization hints\n  optimizeDeps: {\n    include: [\n      'react',\n      'react-dom',\n      'axios',\n      'date-fns',\n      'lodash-es',\n      '@radix-ui/react-dialog',\n      '@radix-ui/react-dropdown-menu',\n      'recharts',\n    ],\n    exclude: ['@vite/client'],\n  },\n\n  server: {\n    // Development optimizations\n    middlewareMode: false,\n    hmr: {\n      protocol: 'ws',\n      host: 'localhost',\n      port: 5173,\n    },\n  },\n});\n
