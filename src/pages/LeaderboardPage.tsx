import React, { useState, useEffect } from 'react';\nimport { Trophy, Medal, Flame } from 'lucide-react';\nimport { useLanguage } from '@/contexts/LanguageContext';\n\ninterface LeaderboardEntry {\n  rank: number;\n  username: string;\n  matchesPlayed: number;\n  winRate: number;\n  avgPerformance: number;\n  achievementsUnlocked: number;\n}\n\nexport default function LeaderboardPage() {\n  const { t } = useLanguage();\n  const [leaderboard, setLeaderboard] = useState<LeaderboardEntry[]>([]);\n  const [timeframe, setTimeframe] = useState<'week' | 'month' | 'all'>('month');\n  const [loading, setLoading] = useState(true);\n  const [userRank, setUserRank] = useState<number | null>(null);\n\n  useEffect(() => {\n    fetchLeaderboard();\n    fetchUserRank();\n  }, [timeframe]);\n\n  const fetchLeaderboard = async () => {\n    try {\n      setLoading(true);\n      const res = await fetch(`/api/gamification/leaderboard?timeframe=${timeframe}`);\n      const data = await res.json();\n      setLeaderboard(data);\n    } catch (error) {\n      console.error('Failed to fetch leaderboard:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchUserRank = async () => {\n    try {\n      const res = await fetch(`/api/gamification/rank?timeframe=${timeframe}`);\n      const data = await res.json();\n      setUserRank(data.rank);\n    } catch (error) {\n      console.error('Failed to fetch user rank:', error);\n    }\n  };\n\n  const getRankIcon = (rank: number) => {\n    if (rank === 1) return 'ðŸ¥‡';\n    if (rank === 2) return 'ðŸ¥ˆ';\n    if (rank === 3) return 'ðŸ¥‰';\n    return `#${rank}`;\n  };\n\n  const getRankColor = (rank: number) => {\n    if (rank === 1) return 'text-yellow-400';\n    if (rank === 2) return 'text-gray-300';\n    if (rank === 3) return 'text-orange-400';\n    return 'text-cyan-400';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 p-6 scanlines\">\n      {/* Background effects */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-0 left-1/4 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl\"></div>\n        <div className=\"absolute bottom-0 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl\"></div>\n      </div>\n\n      <div className=\"relative max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-3 mb-2\">\n            <Trophy className=\"w-8 h-8 text-yellow-400\" />\n            <h1 className=\"text-4xl font-bold text-cyan-400 uppercase tracking-widest\">\n              LEADERBOARD\n            </h1>\n          </div>\n          <p className=\"text-muted-foreground uppercase tracking-wider text-sm\">\n            Top players of TrixieVerse\n          </p>\n        </div>\n\n        {/* Timeframe selector */}\n        <div className=\"flex gap-3 mb-8\">\n          {(['week', 'month', 'all'] as const).map((tf) => (\n            <button\n              key={tf}\n              onClick={() => setTimeframe(tf)}\n              className={`px-6 py-2 rounded-sm font-bold uppercase tracking-wider transition-all ${\n                timeframe === tf\n                  ? 'bg-cyan-500 text-black neon-glow'\n                  : 'bg-slate-900/50 border border-cyan-500/30 text-cyan-400 hover:border-cyan-500/60'\n              }`}\n            >\n              {tf === 'week' ? 'This Week' : tf === 'month' ? 'This Month' : 'All Time'}\n            </button>\n          ))}\n        </div>\n\n        {/* Your rank */}\n        {userRank && (\n          <div className=\"coaching-card p-6 bg-gradient-to-br from-purple-500/10 to-purple-500/5 border-2 border-purple-500/30 neon-glow mb-8\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-muted-foreground uppercase tracking-wider\">Your Rank</p>\n                <p className=\"text-3xl font-bold text-purple-400\">#{userRank}</p>\n              </div>\n              <Flame className=\"w-12 h-12 text-purple-400\" />\n            </div>\n          </div>\n        )}\n\n        {/* Leaderboard table */}\n        <div className=\"coaching-card bg-gradient-to-br from-slate-900/80 to-blue-900/40 border-2 border-cyan-500/30 neon-glow overflow-hidden\">\n          {loading ? (\n            <div className=\"p-8 text-center text-cyan-400\">Loading leaderboard...</div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead>\n                  <tr className=\"border-b border-cyan-500/30 bg-cyan-500/10\">\n                    <th className=\"px-6 py-4 text-left text-xs font-bold text-cyan-400 uppercase tracking-wider\">\n                      Rank\n                    </th>\n                    <th className=\"px-6 py-4 text-left text-xs font-bold text-cyan-400 uppercase tracking-wider\">\n                      Player\n                    </th>\n                    <th className=\"px-6 py-4 text-center text-xs font-bold text-cyan-400 uppercase tracking-wider\">\n                      Matches\n                    </th>\n                    <th className=\"px-6 py-4 text-center text-xs font-bold text-cyan-400 uppercase tracking-wider\">\n                      Win Rate\n                    </th>\n                    <th className=\"px-6 py-4 text-center text-xs font-bold text-cyan-400 uppercase tracking-wider\">\n                      Avg Performance\n                    </th>\n                    <th className=\"px-6 py-4 text-center text-xs font-bold text-cyan-400 uppercase tracking-wider\">\n                      Achievements\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {leaderboard.map((entry, idx) => (\n                    <tr\n                      key={idx}\n                      className=\"border-b border-cyan-500/10 hover:bg-cyan-500/5 transition-colors\"\n                    >\n                      <td className={`px-6 py-4 font-bold text-lg ${getRankColor(entry.rank)}`}>\n                        {getRankIcon(entry.rank)}\n                      </td>\n                      <td className=\"px-6 py-4 text-foreground font-semibold\">\n                        {entry.username}\n                      </td>\n                      <td className=\"px-6 py-4 text-center text-cyan-400\">\n                        {entry.matchesPlayed}\n                      </td>\n                      <td className=\"px-6 py-4 text-center\">\n                        <span className=\"px-3 py-1 rounded-sm bg-green-500/20 text-green-400 text-sm font-bold\">\n                          {entry.winRate.toFixed(1)}%\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 text-center\">\n                        <span className=\"px-3 py-1 rounded-sm bg-purple-500/20 text-purple-400 text-sm font-bold\">\n                          {entry.avgPerformance.toFixed(0)}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 text-center text-orange-400 font-bold\">\n                        {entry.achievementsUnlocked}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n
