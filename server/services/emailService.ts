/**\n * Email Service\n * Handles all email communications\n */\n\nimport nodemailer from 'nodemailer';\nimport logger from '../utils/logger';\n\ninterface EmailOptions {\n  to: string;\n  subject: string;\n  html: string;\n  text?: string;\n}\n\nclass EmailService {\n  private transporter: nodemailer.Transporter | null = null;\n\n  constructor() {\n    this.initializeTransporter();\n  }\n\n  /**\n   * Initialize email transporter\n   */\n  private initializeTransporter(): void {\n    try {\n      if (process.env.SMTP_HOST && process.env.SMTP_USER && process.env.SMTP_PASS) {\n        this.transporter = nodemailer.createTransport({\n          host: process.env.SMTP_HOST,\n          port: parseInt(process.env.SMTP_PORT || '587'),\n          secure: process.env.SMTP_SECURE === 'true',\n          auth: {\n            user: process.env.SMTP_USER,\n            pass: process.env.SMTP_PASS,\n          },\n        });\n\n        logger.info('Email service initialized');\n      } else {\n        logger.warn('Email service not configured - using console logging');\n      }\n    } catch (error) {\n      logger.error({ message: 'Failed to initialize email service', error });\n    }\n  }\n\n  /**\n   * Send email\n   */\n  async sendEmail(options: EmailOptions): Promise<boolean> {\n    try {\n      if (!this.transporter) {\n        logger.info(`[EMAIL] ${options.to}: ${options.subject}`);\n        return true;\n      }\n\n      const result = await this.transporter.sendMail({\n        from: process.env.SMTP_FROM || 'noreply@trixieverse.com',\n        ...options,\n      });\n\n      logger.info(`Email sent to ${options.to}`);\n      return true;\n    } catch (error) {\n      logger.error({ message: 'Failed to send email', error, to: options.to });\n      return false;\n    }\n  }\n\n  /**\n   * Send welcome email\n   */\n  async sendWelcomeEmail(email: string, username: string): Promise<boolean> {\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #0a0e27 0%, #1e3a8a 100%); padding: 40px; text-align: center; color: #00d4ff;\">\n          <h1 style=\"margin: 0; font-size: 32px; text-transform: uppercase; letter-spacing: 2px;\">‚öîÔ∏è WELCOME TO TRIXIEVERSE</h1>\n        </div>\n        <div style=\"padding: 40px; background: #f5f5f5;\">\n          <p style=\"font-size: 18px; color: #333; margin-bottom: 20px;\">Hey <strong>${username}</strong>! üéÆ</p>\n          <p style=\"font-size: 16px; color: #666; line-height: 1.6; margin-bottom: 20px;\">\n            Welcome to TrixieVerse, where every player becomes a legend. Your personal AI coach is ready to help you reach new heights in Wild Rift.\n          </p>\n          <p style=\"font-size: 16px; color: #666; line-height: 1.6; margin-bottom: 20px;\">\n            <strong>What's next?</strong>\n          </p>\n          <ul style=\"font-size: 16px; color: #666; line-height: 1.8;\">\n            <li>Connect your Wild Rift account</li>\n            <li>Customize your coach personality</li>\n            <li>Start your first match analysis</li>\n            <li>Join the community</li>\n          </ul>\n          <a href=\"${process.env.FRONTEND_URL}/dashboard\" style=\"display: inline-block; margin-top: 30px; padding: 15px 40px; background: #00d4ff; color: #000; text-decoration: none; font-weight: bold; text-transform: uppercase; border-radius: 4px; letter-spacing: 1px;\">\n            GET STARTED\n          </a>\n        </div>\n        <div style=\"padding: 20px; background: #0a0e27; color: #00d4ff; text-align: center; font-size: 12px;\">\n          <p style=\"margin: 0;\">¬© 2024 TrixieVerse. All rights reserved.</p>\n          <p style=\"margin: 5px 0 0 0;\">A tribute to TR1XON from EUW</p>\n        </div>\n      </div>\n    `;\n\n    return this.sendEmail({\n      to: email,\n      subject: 'üéÆ Welcome to TrixieVerse!',\n      html,\n    });\n  }\n\n  /**\n   * Send password reset email\n   */\n  async sendPasswordResetEmail(email: string, resetToken: string): Promise<boolean> {\n    const resetLink = `${process.env.FRONTEND_URL}/reset-password?token=${resetToken}`;\n\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #0a0e27 0%, #1e3a8a 100%); padding: 40px; text-align: center; color: #00d4ff;\">\n          <h1 style=\"margin: 0; font-size: 32px; text-transform: uppercase; letter-spacing: 2px;\">PASSWORD RESET</h1>\n        </div>\n        <div style=\"padding: 40px; background: #f5f5f5;\">\n          <p style=\"font-size: 16px; color: #666; margin-bottom: 20px;\">We received a request to reset your password.</p>\n          <p style=\"font-size: 16px; color: #666; margin-bottom: 30px;\">Click the button below to reset your password. This link will expire in 1 hour.</p>\n          <a href=\"${resetLink}\" style=\"display: inline-block; padding: 15px 40px; background: #00d4ff; color: #000; text-decoration: none; font-weight: bold; text-transform: uppercase; border-radius: 4px; letter-spacing: 1px;\">\n            RESET PASSWORD\n          </a>\n          <p style=\"font-size: 14px; color: #999; margin-top: 30px; border-top: 1px solid #ddd; padding-top: 20px;\">\n            If you didn't request this, you can ignore this email.\n          </p>\n        </div>\n        <div style=\"padding: 20px; background: #0a0e27; color: #00d4ff; text-align: center; font-size: 12px;\">\n          <p style=\"margin: 0;\">¬© 2024 TrixieVerse. All rights reserved.</p>\n        </div>\n      </div>\n    `;\n\n    return this.sendEmail({\n      to: email,\n      subject: 'üîê Reset Your TrixieVerse Password',\n      html,\n    });\n  }\n\n  /**\n   * Send achievement notification\n   */\n  async sendAchievementEmail(email: string, username: string, achievement: string): Promise<boolean> {\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #0a0e27 0%, #1e3a8a 100%); padding: 40px; text-align: center; color: #fbbf24;\">\n          <h1 style=\"margin: 0; font-size: 32px; text-transform: uppercase; letter-spacing: 2px;\">üèÜ ACHIEVEMENT UNLOCKED!</h1>\n        </div>\n        <div style=\"padding: 40px; background: #f5f5f5;\">\n          <p style=\"font-size: 18px; color: #333; margin-bottom: 20px;\">Congratulations <strong>${username}</strong>!</p>\n          <p style=\"font-size: 20px; color: #fbbf24; font-weight: bold; margin-bottom: 20px; text-align: center;\">\n            ${achievement}\n          </p>\n          <p style=\"font-size: 16px; color: #666; line-height: 1.6;\">\n            You've reached a new milestone! Keep up the amazing progress and continue climbing the ranks.\n          </p>\n          <a href=\"${process.env.FRONTEND_URL}/dashboard\" style=\"display: inline-block; margin-top: 30px; padding: 15px 40px; background: #fbbf24; color: #000; text-decoration: none; font-weight: bold; text-transform: uppercase; border-radius: 4px; letter-spacing: 1px;\">\n            VIEW ACHIEVEMENT\n          </a>\n        </div>\n        <div style=\"padding: 20px; background: #0a0e27; color: #00d4ff; text-align: center; font-size: 12px;\">\n          <p style=\"margin: 0;\">¬© 2024 TrixieVerse. All rights reserved.</p>\n        </div>\n      </div>\n    `;\n\n    return this.sendEmail({\n      to: email,\n      subject: `üèÜ Achievement Unlocked: ${achievement}`,\n      html,\n    });\n  }\n\n  /**\n   * Send rank up notification\n   */\n  async sendRankUpEmail(email: string, username: string, newRank: string): Promise<boolean> {\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #0a0e27 0%, #1e3a8a 100%); padding: 40px; text-align: center; color: #10b981;\">\n          <h1 style=\"margin: 0; font-size: 32px; text-transform: uppercase; letter-spacing: 2px;\">üìà RANK UP!</h1>\n        </div>\n        <div style=\"padding: 40px; background: #f5f5f5;\">\n          <p style=\"font-size: 18px; color: #333; margin-bottom: 20px;\">Amazing work, <strong>${username}</strong>! üéâ</p>\n          <p style=\"font-size: 20px; color: #10b981; font-weight: bold; margin-bottom: 20px; text-align: center;\">\n            You've reached ${newRank}!\n          </p>\n          <p style=\"font-size: 16px; color: #666; line-height: 1.6;\">\n            Your dedication and hard work have paid off. You're on your way to becoming a legend in Wild Rift!\n          </p>\n          <a href=\"${process.env.FRONTEND_URL}/dashboard\" style=\"display: inline-block; margin-top: 30px; padding: 15px 40px; background: #10b981; color: #fff; text-decoration: none; font-weight: bold; text-transform: uppercase; border-radius: 4px; letter-spacing: 1px;\">\n            VIEW PROFILE\n          </a>\n        </div>\n        <div style=\"padding: 20px; background: #0a0e27; color: #00d4ff; text-align: center; font-size: 12px;\">\n          <p style=\"margin: 0;\">¬© 2024 TrixieVerse. All rights reserved.</p>\n        </div>\n      </div>\n    `;\n\n    return this.sendEmail({\n      to: email,\n      subject: `üìà Rank Up: ${newRank}!`,\n      html,\n    });\n  }\n\n  /**\n   * Send match analysis email\n   */\n  async sendMatchAnalysisEmail(\n    email: string,\n    username: string,\n    matchStats: { result: string; performance: number; duration: number }\n  ): Promise<boolean> {\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #0a0e27 0%, #1e3a8a 100%); padding: 40px; text-align: center; color: #00d4ff;\">\n          <h1 style=\"margin: 0; font-size: 32px; text-transform: uppercase; letter-spacing: 2px;\">‚öîÔ∏è MATCH ANALYSIS</h1>\n        </div>\n        <div style=\"padding: 40px; background: #f5f5f5;\">\n          <p style=\"font-size: 18px; color: #333; margin-bottom: 20px;\">Hey <strong>${username}</strong>!</p>\n          <p style=\"font-size: 16px; color: #666; margin-bottom: 30px;\">Here's your match analysis:</p>\n          <div style=\"background: #fff; padding: 20px; border-radius: 8px; border-left: 4px solid #00d4ff;\">\n            <p style=\"margin: 10px 0; font-size: 16px; color: #333;\">\n              <strong>Result:</strong> <span style=\"color: ${matchStats.result === 'win' ? '#10b981' : '#ef4444'};\">${matchStats.result.toUpperCase()}</span>\n            </p>\n            <p style=\"margin: 10px 0; font-size: 16px; color: #333;\">\n              <strong>Performance:</strong> ${matchStats.performance}/100\n            </p>\n            <p style=\"margin: 10px 0; font-size: 16px; color: #333;\">\n              <strong>Duration:</strong> ${matchStats.duration} minutes\n            </p>\n          </div>\n          <a href=\"${process.env.FRONTEND_URL}/war-room\" style=\"display: inline-block; margin-top: 30px; padding: 15px 40px; background: #00d4ff; color: #000; text-decoration: none; font-weight: bold; text-transform: uppercase; border-radius: 4px; letter-spacing: 1px;\">\n            VIEW FULL ANALYSIS\n          </a>\n        </div>\n        <div style=\"padding: 20px; background: #0a0e27; color: #00d4ff; text-align: center; font-size: 12px;\">\n          <p style=\"margin: 0;\">¬© 2024 TrixieVerse. All rights reserved.</p>\n        </div>\n      </div>\n    `;\n\n    return this.sendEmail({\n      to: email,\n      subject: `‚öîÔ∏è Match Analysis: ${matchStats.result.toUpperCase()}`,\n      html,\n    });\n  }\n}\n\nexport default new EmailService();\n
